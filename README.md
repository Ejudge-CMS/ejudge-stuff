# Ejudge-контейнер: сборная солянка

## Контейнер изолированного запуска

Модифицированная версия контейнера для запуска недоверенных программ, написанная А.Черновым для тестирующей системы [Ejudge](https://ejudge.ru).

### Возможности

1. С помощью seccomp позволяет фильтровать системные вызовы (fork, exec, clone, unshare, memfd ...).
2. С помощью cgoup и namespaces умеет отсекать программы по времени и памяти.

### Инсталляция

Установите и скомпилируйте файл **suid-container.c** с заголовком **defines.h**.

### Использование

См. [инструкцию](https://ejudge.ru/wiki/index.php/Ej-suid-container).

## Двойной запуск

Также написан заголовочный файл **runtwice_seccomp.h** и файл **up_filter.c**, предоставляющие возможность фильтрации системных вызовов. Для использования необходимо _отключить_ фильтрацию системных вызовов во встроенном контейнере, и заполнить соответствующие функции в коде:

1. **process_input** - читает из входного файла, выводит на вход первому запуску
2. **process_first_run** - читает из вывода первого запуска, выводит на вывод второму запуску
3. **process_final** - читает из вывода второго запуска, выводит в выходной файл (в первой строке необходимо вывести 0).

После любого чтения строку НЕ переводить, после любой записи строку НАДО переводить.