# Ejudge: some stuff

## Контейнер изолированного запуска

Модифицированная версия контейнера для запуска недоверенных программ, написанная А.Черновым для тестирующей системы [Ejudge](https://ejudge.ru).

### Инсталляция

Клонируйте репозиторий, зайдите в папку **container** и запустите установочный скрипт **setup.sh** от пользователя **root**.

### Использование

См. [инструкцию](https://ejudge.ru/wiki/index.php/Ej-suid-container). ЗАПЯТУЮ ПЕРЕД ПУТЁМ СТАВИТЬ НЕ НАДО! Также были выкинуты опции mo, mp, mg, mG, mC.

## Двойной запуск

#### Использование

Также написан файл **start.cpp**, предоставляющий возможность фильтрации системных вызовов в задачах с двойным запуском. Для использования необходимо _отключить_ фильтрацию системных вызовов (опция **s0** в переменной **container_options** в конфиге задачи) во встроенном контейнере, и заполнить соответствующие функции в коде файла **template.cpp**:

1. **process_input** - читает из входного файла, выводит на вход первому запуску
2. **process_first_run** - читает из вывода первого запуска, выводит на вывод второму запуску
3. **process_second_run** - читает из вывода второго запуска, выводит в выходной файл, доступный чекеру.

Далее необходимо скомпилировать:

```console
g++ /path/to/start.cpp /path/to/template.cpp -D'INPUTFILE="<input file name>"' -o start
```

`<input file name>` - имя файла со входными данными (по умолчанию input). Скрипт его будет удалять (с.в. **unlink**) перед запуском программмы участника.

Полученный файл **start** необходимо вписать как **start_cmd** в конфиг задачи.